var CVSS31={CVSSVersionIdentifier:"CVSS:3.1",exploitabilityCoefficient:8.22,scopeCoefficient:1.08,vectorStringRegex_31:/^CVSS:3\.1\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/,Weight:{AV:{N:.85,A:.62,L:.55,P:.2},AC:{H:.44,L:.77},PR:{U:{N:.85,L:.62,H:.27},C:{N:.85,L:.68,H:.5}},UI:{N:.85,R:.62},S:{U:6.42,C:7.52},CIA:{N:0,L:.22,H:.56},E:{X:1,U:.91,P:.94,F:.97,H:1},RL:{X:1,O:.95,T:.96,W:.97,U:1},RC:{X:1,U:.92,R:.96,C:1},CIAR:{X:1,L:.5,M:1,H:1.5}},severityRatings:[{name:"None",bottom:0,top:0},{name:"Low",bottom:.1,top:3.9},{name:"Medium",bottom:4,top:6.9},{name:"High",bottom:7,top:8.9},{name:"Critical",bottom:9,top:10}],calculateCVSSFromMetrics:function(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X){var h=[];if(void 0!==e&&""!==e||h.push("AV"),void 0!==i&&""!==i||h.push("AC"),void 0!==t&&""!==t||h.push("PR"),void 0!==r&&""!==r||h.push("UI"),void 0!==o&&""!==o||h.push("S"),void 0!==n&&""!==n||h.push("C"),void 0!==a&&""!==a||h.push("I"),void 0!==S&&""!==S||h.push("A"),h.length>0)return{success:!1,errorType:"MissingBaseMetric",errorMetrics:h};var I=e,y=i,g=t,u=r,N=o,f=n,L=a,U=S,P=_||"X",O=s||"X",E=C||"X",W=c||"X",w=M||"X",H=d||"X",b=p||"X",F=l||"X",x=v||"X",T=m||"X",D=V||"X",q=A||"X",k=R||"X",B=X||"X";if(CVSS31.Weight.AV.hasOwnProperty(I)||h.push("AV"),CVSS31.Weight.AC.hasOwnProperty(y)||h.push("AC"),CVSS31.Weight.PR.U.hasOwnProperty(g)||h.push("PR"),CVSS31.Weight.UI.hasOwnProperty(u)||h.push("UI"),CVSS31.Weight.S.hasOwnProperty(N)||h.push("S"),CVSS31.Weight.CIA.hasOwnProperty(f)||h.push("C"),CVSS31.Weight.CIA.hasOwnProperty(L)||h.push("I"),CVSS31.Weight.CIA.hasOwnProperty(U)||h.push("A"),CVSS31.Weight.E.hasOwnProperty(P)||h.push("E"),CVSS31.Weight.RL.hasOwnProperty(O)||h.push("RL"),CVSS31.Weight.RC.hasOwnProperty(E)||h.push("RC"),"X"===W||CVSS31.Weight.CIAR.hasOwnProperty(W)||h.push("CR"),"X"===w||CVSS31.Weight.CIAR.hasOwnProperty(w)||h.push("IR"),"X"===H||CVSS31.Weight.CIAR.hasOwnProperty(H)||h.push("AR"),"X"===b||CVSS31.Weight.AV.hasOwnProperty(b)||h.push("MAV"),"X"===F||CVSS31.Weight.AC.hasOwnProperty(F)||h.push("MAC"),"X"===x||CVSS31.Weight.PR.U.hasOwnProperty(x)||h.push("MPR"),"X"===T||CVSS31.Weight.UI.hasOwnProperty(T)||h.push("MUI"),"X"===D||CVSS31.Weight.S.hasOwnProperty(D)||h.push("MS"),"X"===q||CVSS31.Weight.CIA.hasOwnProperty(q)||h.push("MC"),"X"===k||CVSS31.Weight.CIA.hasOwnProperty(k)||h.push("MI"),"X"===B||CVSS31.Weight.CIA.hasOwnProperty(B)||h.push("MA"),h.length>0)return{success:!1,errorType:"UnknownMetricValue",errorMetrics:h};var G,K,Y,J,Q=CVSS31.Weight.AV[I],$=CVSS31.Weight.AC[y],j=CVSS31.Weight.PR[N][g],z=CVSS31.Weight.UI[u],Z=CVSS31.Weight.S[N],ee=CVSS31.Weight.CIA[f],ie=CVSS31.Weight.CIA[L],te=CVSS31.Weight.CIA[U],re=CVSS31.Weight.E[P],oe=CVSS31.Weight.RL[O],ne=CVSS31.Weight.RC[E],ae=CVSS31.Weight.CIAR[W],Se=CVSS31.Weight.CIAR[w],_e=CVSS31.Weight.CIAR[H],se=CVSS31.Weight.AV["X"!==b?b:I],Ce=CVSS31.Weight.AC["X"!==F?F:y],ce=CVSS31.Weight.PR["X"!==D?D:N]["X"!==x?x:g],Me=CVSS31.Weight.UI["X"!==T?T:u],de=CVSS31.Weight.S["X"!==D?D:N],pe=CVSS31.Weight.CIA["X"!==q?q:f],le=CVSS31.Weight.CIA["X"!==k?k:L],ve=CVSS31.Weight.CIA["X"!==B?B:U];G=1-(1-ee)*(1-ie)*(1-te),K="U"===N?Z*G:Z*(G-.029)-3.25*Math.pow(G-.02,15),Y=CVSS31.exploitabilityCoefficient*Q*$*j*z,J=K<=0?0:"U"===N?CVSS31.roundUp1(Math.min(Y+K,10)):CVSS31.roundUp1(Math.min(CVSS31.scopeCoefficient*(Y+K),10));var me,Ve,Ae,Re,Xe=CVSS31.roundUp1(J*re*oe*ne);me=Math.min(1-(1-pe*ae)*(1-le*Se)*(1-ve*_e),.915),Ve="U"===D||"X"===D&&"U"===N?de*me:de*(me-.029)-3.25*Math.pow(.9731*me-.02,13),Re=CVSS31.exploitabilityCoefficient*se*Ce*ce*Me,Ae=Ve<=0?0:"U"===D||"X"===D&&"U"===N?CVSS31.roundUp1(CVSS31.roundUp1(Math.min(Ve+Re,10))*re*oe*ne):CVSS31.roundUp1(CVSS31.roundUp1(Math.min(CVSS31.scopeCoefficient*(Ve+Re),10))*re*oe*ne);var he=CVSS31.CVSSVersionIdentifier+"/AV:"+I+"/AC:"+y+"/PR:"+g+"/UI:"+u+"/S:"+N+"/C:"+f+"/I:"+L+"/A:"+U;return"X"!==P&&(he=he+"/E:"+P),"X"!==O&&(he=he+"/RL:"+O),"X"!==E&&(he=he+"/RC:"+E),"X"!==W&&(he=he+"/CR:"+W),"X"!==w&&(he=he+"/IR:"+w),"X"!==H&&(he=he+"/AR:"+H),"X"!==b&&(he=he+"/MAV:"+b),"X"!==F&&(he=he+"/MAC:"+F),"X"!==x&&(he=he+"/MPR:"+x),"X"!==T&&(he=he+"/MUI:"+T),"X"!==D&&(he=he+"/MS:"+D),"X"!==q&&(he=he+"/MC:"+q),"X"!==k&&(he=he+"/MI:"+k),"X"!==B&&(he=he+"/MA:"+B),{success:!0,baseMetricScore:J.toFixed(1),baseSeverity:CVSS31.severityRating(J.toFixed(1)),baseISS:G,baseImpact:K,baseExploitability:Y,temporalMetricScore:Xe.toFixed(1),temporalSeverity:CVSS31.severityRating(Xe.toFixed(1)),environmentalMetricScore:Ae.toFixed(1),environmentalSeverity:CVSS31.severityRating(Ae.toFixed(1)),environmentalMISS:me,environmentalModifiedImpact:Ve,environmentalModifiedExploitability:Re,vectorString:he}},calculateCVSSFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS31.vectorStringRegex_31.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS31.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");void 0===i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS31.calculateCVSSFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)},roundUp1:function(e){var i=Math.round(1e5*e);return i%1e4==0?i/1e5:(Math.floor(i/1e4)+1)/10},severityRating:function(e){var i=CVSS31.severityRatings.length,t=Number(e);if(isNaN(t))return t;for(var r=0;r<i;r++)if(e>=CVSS31.severityRatings[r].bottom&&e<=CVSS31.severityRatings[r].top)return CVSS31.severityRatings[r].name},XML_MetricNames:{E:{X:"NOT_DEFINED",U:"UNPROVEN",P:"PROOF_OF_CONCEPT",F:"FUNCTIONAL",H:"HIGH"},RL:{X:"NOT_DEFINED",O:"OFFICIAL_FIX",T:"TEMPORARY_FIX",W:"WORKAROUND",U:"UNAVAILABLE"},RC:{X:"NOT_DEFINED",U:"UNKNOWN",R:"REASONABLE",C:"CONFIRMED"},CIAR:{X:"NOT_DEFINED",L:"LOW",M:"MEDIUM",H:"HIGH"},MAV:{N:"NETWORK",A:"ADJACENT_NETWORK",L:"LOCAL",P:"PHYSICAL",X:"NOT_DEFINED"},MAC:{H:"HIGH",L:"LOW",X:"NOT_DEFINED"},MPR:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"},MUI:{N:"NONE",R:"REQUIRED",X:"NOT_DEFINED"},MS:{U:"UNCHANGED",C:"CHANGED",X:"NOT_DEFINED"},MCIA:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"}},generateXMLFromMetrics:function(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X){var h=CVSS31.calculateCVSSFromMetrics(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X);if(!0!==h.success)return h;var I='<?xml version="1.0" encoding="UTF-8"?>\n<cvssv3.1 xmlns="https://www.first.org/cvss/cvss-v3.1.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="https://www.first.org/cvss/cvss-v3.1.xsd https://www.first.org/cvss/cvss-v3.1.xsd"\n  >\n\n  <base_metrics>\n    <attack-vector>__AttackVector__</attack-vector>\n    <attack-complexity>__AttackComplexity__</attack-complexity>\n    <privileges-required>__PrivilegesRequired__</privileges-required>\n    <user-interaction>__UserInteraction__</user-interaction>\n    <scope>__Scope__</scope>\n    <confidentiality-impact>__Confidentiality__</confidentiality-impact>\n    <integrity-impact>__Integrity__</integrity-impact>\n    <availability-impact>__Availability__</availability-impact>\n    <base-score>__BaseScore__</base-score>\n    <base-severity>__BaseSeverityRating__</base-severity>\n  </base_metrics>\n\n  <temporal_metrics>\n    <exploit-code-maturity>__ExploitCodeMaturity__</exploit-code-maturity>\n    <remediation-level>__RemediationLevel__</remediation-level>\n    <report-confidence>__ReportConfidence__</report-confidence>\n    <temporal-score>__TemporalScore__</temporal-score>\n    <temporal-severity>__TemporalSeverityRating__</temporal-severity>\n  </temporal_metrics>\n\n  <environmental_metrics>\n    <confidentiality-requirement>__ConfidentialityRequirement__</confidentiality-requirement>\n    <integrity-requirement>__IntegrityRequirement__</integrity-requirement>\n    <availability-requirement>__AvailabilityRequirement__</availability-requirement>\n    <modified-attack-vector>__ModifiedAttackVector__</modified-attack-vector>\n    <modified-attack-complexity>__ModifiedAttackComplexity__</modified-attack-complexity>\n    <modified-privileges-required>__ModifiedPrivilegesRequired__</modified-privileges-required>\n    <modified-user-interaction>__ModifiedUserInteraction__</modified-user-interaction>\n    <modified-scope>__ModifiedScope__</modified-scope>\n    <modified-confidentiality-impact>__ModifiedConfidentiality__</modified-confidentiality-impact>\n    <modified-integrity-impact>__ModifiedIntegrity__</modified-integrity-impact>\n    <modified-availability-impact>__ModifiedAvailability__</modified-availability-impact>\n    <environmental-score>__EnvironmentalScore__</environmental-score>\n    <environmental-severity>__EnvironmentalSeverityRating__</environmental-severity>\n  </environmental_metrics>\n\n</cvssv3.1>\n';return{success:!0,xmlString:I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=I.replace("__AttackVector__",CVSS31.XML_MetricNames.MAV[e])).replace("__AttackComplexity__",CVSS31.XML_MetricNames.MAC[i])).replace("__PrivilegesRequired__",CVSS31.XML_MetricNames.MPR[t])).replace("__UserInteraction__",CVSS31.XML_MetricNames.MUI[r])).replace("__Scope__",CVSS31.XML_MetricNames.MS[o])).replace("__Confidentiality__",CVSS31.XML_MetricNames.MCIA[n])).replace("__Integrity__",CVSS31.XML_MetricNames.MCIA[a])).replace("__Availability__",CVSS31.XML_MetricNames.MCIA[S])).replace("__BaseScore__",h.baseMetricScore)).replace("__BaseSeverityRating__",h.baseSeverity)).replace("__ExploitCodeMaturity__",CVSS31.XML_MetricNames.E[_||"X"])).replace("__RemediationLevel__",CVSS31.XML_MetricNames.RL[s||"X"])).replace("__ReportConfidence__",CVSS31.XML_MetricNames.RC[C||"X"])).replace("__TemporalScore__",h.temporalMetricScore)).replace("__TemporalSeverityRating__",h.temporalSeverity)).replace("__ConfidentialityRequirement__",CVSS31.XML_MetricNames.CIAR[c||"X"])).replace("__IntegrityRequirement__",CVSS31.XML_MetricNames.CIAR[M||"X"])).replace("__AvailabilityRequirement__",CVSS31.XML_MetricNames.CIAR[d||"X"])).replace("__ModifiedAttackVector__",CVSS31.XML_MetricNames.MAV[p||"X"])).replace("__ModifiedAttackComplexity__",CVSS31.XML_MetricNames.MAC[l||"X"])).replace("__ModifiedPrivilegesRequired__",CVSS31.XML_MetricNames.MPR[v||"X"])).replace("__ModifiedUserInteraction__",CVSS31.XML_MetricNames.MUI[m||"X"])).replace("__ModifiedScope__",CVSS31.XML_MetricNames.MS[V||"X"])).replace("__ModifiedConfidentiality__",CVSS31.XML_MetricNames.MCIA[A||"X"])).replace("__ModifiedIntegrity__",CVSS31.XML_MetricNames.MCIA[R||"X"])).replace("__ModifiedAvailability__",CVSS31.XML_MetricNames.MCIA[X||"X"])).replace("__EnvironmentalScore__",h.environmentalMetricScore)).replace("__EnvironmentalSeverityRating__",h.environmentalSeverity)}},generateXMLFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS31.vectorStringRegex_31.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS31.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");void 0===i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS31.generateXMLFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)}};