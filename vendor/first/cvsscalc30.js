var CVSS={CVSSVersionIdentifier:"CVSS:3.0",exploitabilityCoefficient:8.22,scopeCoefficient:1.08,vectorStringRegex_30:/^CVSS:3\.0\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/,Weight:{AV:{N:.85,A:.62,L:.55,P:.2},AC:{H:.44,L:.77},PR:{U:{N:.85,L:.62,H:.27},C:{N:.85,L:.68,H:.5}},UI:{N:.85,R:.62},S:{U:6.42,C:7.52},CIA:{N:0,L:.22,H:.56},E:{X:1,U:.91,P:.94,F:.97,H:1},RL:{X:1,O:.95,T:.96,W:.97,U:1},RC:{X:1,U:.92,R:.96,C:1},CIAR:{X:1,L:.5,M:1,H:1.5}},severityRatings:[{name:"None",bottom:0,top:0},{name:"Low",bottom:.1,top:3.9},{name:"Medium",bottom:4,top:6.9},{name:"High",bottom:7,top:8.9},{name:"Critical",bottom:9,top:10}],calculateCVSSFromMetrics:function(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,v,l,m,V,A,R,X){var h=[];if(void 0!==e&&""!==e||h.push("AV"),void 0!==i&&""!==i||h.push("AC"),void 0!==t&&""!==t||h.push("PR"),void 0!==r&&""!==r||h.push("UI"),void 0!==o&&""!==o||h.push("S"),void 0!==n&&""!==n||h.push("C"),void 0!==a&&""!==a||h.push("I"),void 0!==_&&""!==_||h.push("A"),h.length>0)return{success:!1,errorType:"MissingBaseMetric",errorMetrics:h};var I=e,g=i,y=t,u=r,N=o,f=n,L=a,U=_,P=S||"X",O=C||"X",E=s||"X",W=c||"X",w=M||"X",H=p||"X",F=d||"X",b=v||"X",x=l||"X",T=m||"X",D=V||"X",q=A||"X",k=R||"X",B=X||"X";if(CVSS.Weight.AV.hasOwnProperty(I)||h.push("AV"),CVSS.Weight.AC.hasOwnProperty(g)||h.push("AC"),CVSS.Weight.PR.U.hasOwnProperty(y)||h.push("PR"),CVSS.Weight.UI.hasOwnProperty(u)||h.push("UI"),CVSS.Weight.S.hasOwnProperty(N)||h.push("S"),CVSS.Weight.CIA.hasOwnProperty(f)||h.push("C"),CVSS.Weight.CIA.hasOwnProperty(L)||h.push("I"),CVSS.Weight.CIA.hasOwnProperty(U)||h.push("A"),CVSS.Weight.E.hasOwnProperty(P)||h.push("E"),CVSS.Weight.RL.hasOwnProperty(O)||h.push("RL"),CVSS.Weight.RC.hasOwnProperty(E)||h.push("RC"),"X"===W||CVSS.Weight.CIAR.hasOwnProperty(W)||h.push("CR"),"X"===w||CVSS.Weight.CIAR.hasOwnProperty(w)||h.push("IR"),"X"===H||CVSS.Weight.CIAR.hasOwnProperty(H)||h.push("AR"),"X"===F||CVSS.Weight.AV.hasOwnProperty(F)||h.push("MAV"),"X"===b||CVSS.Weight.AC.hasOwnProperty(b)||h.push("MAC"),"X"===x||CVSS.Weight.PR.U.hasOwnProperty(x)||h.push("MPR"),"X"===T||CVSS.Weight.UI.hasOwnProperty(T)||h.push("MUI"),"X"===D||CVSS.Weight.S.hasOwnProperty(D)||h.push("MS"),"X"===q||CVSS.Weight.CIA.hasOwnProperty(q)||h.push("MC"),"X"===k||CVSS.Weight.CIA.hasOwnProperty(k)||h.push("MI"),"X"===B||CVSS.Weight.CIA.hasOwnProperty(B)||h.push("MA"),h.length>0)return{success:!1,errorType:"UnknownMetricValue",errorMetrics:h};var G,K,Y=CVSS.Weight.AV[I],J=CVSS.Weight.AC[g],Q=CVSS.Weight.PR[N][y],$=CVSS.Weight.UI[u],j=CVSS.Weight.S[N],z=CVSS.Weight.CIA[f],Z=CVSS.Weight.CIA[L],ee=CVSS.Weight.CIA[U],ie=CVSS.Weight.E[P],te=CVSS.Weight.RL[O],re=CVSS.Weight.RC[E],oe=CVSS.Weight.CIAR[W],ne=CVSS.Weight.CIAR[w],ae=CVSS.Weight.CIAR[H],_e=CVSS.Weight.AV["X"!==F?F:I],Se=CVSS.Weight.AC["X"!==b?b:g],Ce=CVSS.Weight.PR["X"!==D?D:N]["X"!==x?x:y],se=CVSS.Weight.UI["X"!==T?T:u],ce=CVSS.Weight.S["X"!==D?D:N],Me=CVSS.Weight.CIA["X"!==q?q:f],pe=CVSS.Weight.CIA["X"!==k?k:L],de=CVSS.Weight.CIA["X"!==B?B:U],ve=CVSS.exploitabilityCoefficient*Y*J*Q*$,le=1-(1-z)*(1-Z)*(1-ee);G=(K="U"===N?j*le:j*(le-.029)-3.25*Math.pow(le-.02,15))<=0?0:"U"===N?CVSS.roundUp1(Math.min(ve+K,10)):CVSS.roundUp1(Math.min((ve+K)*CVSS.scopeCoefficient,10));var me,Ve,Ae=CVSS.roundUp1(G*ie*te*re),Re=CVSS.exploitabilityCoefficient*_e*Se*Ce*se,Xe=Math.min(1-(1-Me*oe)*(1-pe*ne)*(1-de*ae),.915);"U"===D||"X"===D&&"U"===N?(Ve=ce*Xe,me=CVSS.roundUp1(CVSS.roundUp1(Math.min(Ve+Re,10))*ie*te*re)):(Ve=ce*(Xe-.029)-3.25*Math.pow(Xe-.02,15),me=CVSS.roundUp1(CVSS.roundUp1(Math.min(CVSS.scopeCoefficient*(Ve+Re),10))*ie*te*re)),Ve<=0&&(me=0);var he=CVSS.CVSSVersionIdentifier+"/AV:"+I+"/AC:"+g+"/PR:"+y+"/UI:"+u+"/S:"+N+"/C:"+f+"/I:"+L+"/A:"+U;return"X"!==P&&(he=he+"/E:"+P),"X"!==O&&(he=he+"/RL:"+O),"X"!==E&&(he=he+"/RC:"+E),"X"!==W&&(he=he+"/CR:"+W),"X"!==w&&(he=he+"/IR:"+w),"X"!==H&&(he=he+"/AR:"+H),"X"!==F&&(he=he+"/MAV:"+F),"X"!==b&&(he=he+"/MAC:"+b),"X"!==x&&(he=he+"/MPR:"+x),"X"!==T&&(he=he+"/MUI:"+T),"X"!==D&&(he=he+"/MS:"+D),"X"!==q&&(he=he+"/MC:"+q),"X"!==k&&(he=he+"/MI:"+k),"X"!==B&&(he=he+"/MA:"+B),{success:!0,baseMetricScore:G.toFixed(1),baseSeverity:CVSS.severityRating(G.toFixed(1)),temporalMetricScore:Ae.toFixed(1),temporalSeverity:CVSS.severityRating(Ae.toFixed(1)),environmentalMetricScore:me.toFixed(1),environmentalSeverity:CVSS.severityRating(me.toFixed(1)),vectorString:he}},calculateCVSSFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");void 0===i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.calculateCVSSFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)},roundUp1:function(e){return Math.ceil(10*e)/10},severityRating:function(e){var i=CVSS.severityRatings.length,t=Number(e);if(isNaN(t))return t;for(var r=0;r<i;r++)if(e>=CVSS.severityRatings[r].bottom&&e<=CVSS.severityRatings[r].top)return CVSS.severityRatings[r].name},XML_MetricNames:{E:{X:"NOT_DEFINED",U:"UNPROVEN",P:"PROOF_OF_CONCEPT",F:"FUNCTIONAL",H:"HIGH"},RL:{X:"NOT_DEFINED",O:"OFFICIAL_FIX",T:"TEMPORARY_FIX",W:"WORKAROUND",U:"UNAVAILABLE"},RC:{X:"NOT_DEFINED",U:"UNKNOWN",R:"REASONABLE",C:"CONFIRMED"},CIAR:{X:"NOT_DEFINED",L:"LOW",M:"MEDIUM",H:"HIGH"},MAV:{N:"NETWORK",A:"ADJACENT_NETWORK",L:"LOCAL",P:"PHYSICAL",X:"NOT_DEFINED"},MAC:{H:"HIGH",L:"LOW",X:"NOT_DEFINED"},MPR:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"},MUI:{N:"NONE",R:"REQUIRED",X:"NOT_DEFINED"},MS:{U:"UNCHANGED",C:"CHANGED",X:"NOT_DEFINED"},MCIA:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"}},generateXMLFromMetrics:function(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,v,l,m,V,A,R,X){var h=CVSS.calculateCVSSFromMetrics(e,i,t,r,o,n,a,_,S,C,s,c,M,p,d,v,l,m,V,A,R,X);if(!0!==h.success)return h;var I='<?xml version="1.0" encoding="UTF-8"?>\n<cvssv3.0 xmlns="https://www.first.org/cvss/cvss-v3.0.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="https://www.first.org/cvss/cvss-v3.0.xsd https://www.first.org/cvss/cvss-v3.0.xsd"\n  >\n\n  <base_metrics>\n    <attack-vector>__AttackVector__</attack-vector>\n    <attack-complexity>__AttackComplexity__</attack-complexity>\n    <privileges-required>__PrivilegesRequired__</privileges-required>\n    <user-interaction>__UserInteraction__</user-interaction>\n    <scope>__Scope__</scope>\n    <confidentiality-impact>__Confidentiality__</confidentiality-impact>\n    <integrity-impact>__Integrity__</integrity-impact>\n    <availability-impact>__Availability__</availability-impact>\n    <base-score>__BaseScore__</base-score>\n    <base-severity>__BaseSeverityRating__</base-severity>\n  </base_metrics>\n\n  <temporal_metrics>\n    <exploit-code-maturity>__ExploitCodeMaturity__</exploit-code-maturity>\n    <remediation-level>__RemediationLevel__</remediation-level>\n    <report-confidence>__ReportConfidence__</report-confidence>\n    <temporal-score>__TemporalScore__</temporal-score>\n    <temporal-severity>__TemporalSeverityRating__</temporal-severity>\n  </temporal_metrics>\n\n  <environmental_metrics>\n    <confidentiality-requirement>__ConfidentialityRequirement__</confidentiality-requirement>\n    <integrity-requirement>__IntegrityRequirement__</integrity-requirement>\n    <availability-requirement>__AvailabilityRequirement__</availability-requirement>\n    <modified-attack-vector>__ModifiedAttackVector__</modified-attack-vector>\n    <modified-attack-complexity>__ModifiedAttackComplexity__</modified-attack-complexity>\n    <modified-privileges-required>__ModifiedPrivilegesRequired__</modified-privileges-required>\n    <modified-user-interaction>__ModifiedUserInteraction__</modified-user-interaction>\n    <modified-scope>__ModifiedScope__</modified-scope>\n    <modified-confidentiality-impact>__ModifiedConfidentiality__</modified-confidentiality-impact>\n    <modified-integrity-impact>__ModifiedIntegrity__</modified-integrity-impact>\n    <modified-availability-impact>__ModifiedAvailability__</modified-availability-impact>\n    <environmental-score>__EnvironmentalScore__</environmental-score>\n    <environmental-severity>__EnvironmentalSeverityRating__</environmental-severity>\n  </environmental_metrics>\n\n</cvssv3.0>\n';return{success:!0,xmlString:I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=(I=I.replace("__AttackVector__",CVSS.XML_MetricNames.MAV[e])).replace("__AttackComplexity__",CVSS.XML_MetricNames.MAC[i])).replace("__PrivilegesRequired__",CVSS.XML_MetricNames.MPR[t])).replace("__UserInteraction__",CVSS.XML_MetricNames.MUI[r])).replace("__Scope__",CVSS.XML_MetricNames.MS[o])).replace("__Confidentiality__",CVSS.XML_MetricNames.MCIA[n])).replace("__Integrity__",CVSS.XML_MetricNames.MCIA[a])).replace("__Availability__",CVSS.XML_MetricNames.MCIA[_])).replace("__BaseScore__",h.baseMetricScore)).replace("__BaseSeverityRating__",h.baseSeverity)).replace("__ExploitCodeMaturity__",CVSS.XML_MetricNames.E[S||"X"])).replace("__RemediationLevel__",CVSS.XML_MetricNames.RL[C||"X"])).replace("__ReportConfidence__",CVSS.XML_MetricNames.RC[s||"X"])).replace("__TemporalScore__",h.temporalMetricScore)).replace("__TemporalSeverityRating__",h.temporalSeverity)).replace("__ConfidentialityRequirement__",CVSS.XML_MetricNames.CIAR[c||"X"])).replace("__IntegrityRequirement__",CVSS.XML_MetricNames.CIAR[M||"X"])).replace("__AvailabilityRequirement__",CVSS.XML_MetricNames.CIAR[p||"X"])).replace("__ModifiedAttackVector__",CVSS.XML_MetricNames.MAV[d||"X"])).replace("__ModifiedAttackComplexity__",CVSS.XML_MetricNames.MAC[v||"X"])).replace("__ModifiedPrivilegesRequired__",CVSS.XML_MetricNames.MPR[l||"X"])).replace("__ModifiedUserInteraction__",CVSS.XML_MetricNames.MUI[m||"X"])).replace("__ModifiedScope__",CVSS.XML_MetricNames.MS[V||"X"])).replace("__ModifiedConfidentiality__",CVSS.XML_MetricNames.MCIA[A||"X"])).replace("__ModifiedIntegrity__",CVSS.XML_MetricNames.MCIA[R||"X"])).replace("__ModifiedAvailability__",CVSS.XML_MetricNames.MCIA[X||"X"])).replace("__EnvironmentalScore__",h.environmentalMetricScore)).replace("__EnvironmentalSeverityRating__",h.environmentalSeverity)}},generateXMLFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS.vectorStringRegex_30.test(e))return{success:!1,errorType:"MalformedVectorString"};var r=e.substring(CVSS.CVSSVersionIdentifier.length).split("/");for(var o in r)if(r.hasOwnProperty(o)){var n=r[o].split(":");void 0===i[n[0]]?i[n[0]]=n[1]:t.push(n[0])}return t.length>0?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS.generateXMLFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)}};